<div class="crud-container">
  <div class="crud-header">
    <h2>Gestión de Pisos</h2>

    <div class="right-actions">
      <input
        type="text"
        placeholder="Buscar pisos..."
        [(ngModel)]="searchTerm"
      />
      <button class="btn btn-success" (click)="openModal(false)">
        <i class="fa-solid fa-plus"></i> Agregar Piso
      </button>
    </div>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Número</th>
        <th>Facultad</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr
        *ngFor="
          let piso of filteredPisos
            | paginate: { itemsPerPage: itemsPerPage, currentPage: page }
        "
      >
        <td>{{ piso.id }}</td>
        <td>{{ piso.numero }}</td>
        <td>{{ piso.facultadId }}</td>
        <td>
          <button class="btn-action edit" (click)="onEditPiso(piso)">
            <i class="fa-solid fa-pen-to-square"></i> Editar
          </button>

          <button class="btn-action delete" (click)="deletePiso(piso.id)">
            <i class="fa-solid fa-trash-can"></i> Eliminar
          </button>
        </td>
      </tr>
    </tbody>
  </table>

    <!-- Paginación -->
    <div class="pagination-controls">
      <pagination-controls
        (pageChange)="page = $event"
        previousLabel="Anterior"
        nextLabel="Siguiente"
      >
      </pagination-controls>
    </div>
  </div>


<div
  class="modal-backdrop"
  *ngIf="modalOpen"
  (click)="closeModal()"
  role="dialog"
  aria-modal="true"
>
  <div class="modal-card" (click)="$event.stopPropagation()">
    <header class="modal-header">
      <h3>{{ isEdit ? 'Editar Piso' : 'Agregar Piso' }}</h3>
      <button class="close-x" (click)="closeModal()">✕</button>
    </header>

    <form (ngSubmit)="savePiso()" #pisoForm="ngForm">
      <div class="modal-body">
        <div class="form-group">
          <label>Número</label>
          <input
            name="numero"
            type="number"
            required
            [(ngModel)]="piso.numero"
            placeholder="Ej: 1"
          />
        </div>

        <div class="form-group">
          <label>Facultad</label>
          <select name="facultadId" [(ngModel)]="piso.facultadId" required>
            <option value="">-- Selecciona una facultad --</option>
            <option *ngFor="let f of facultades" [value]="f.id">
              {{ f.nombre }}
            </option>
          </select>
        </div>
      </div>

      <div class="modal-actions">
        <button
          type="submit"
          class="btn btn-success"
          [disabled]="pisoForm.invalid"
        >
          {{ isEdit ? 'Guardar' : 'Crear' }}
        </button>
        <button type="button" class="btn btn-danger" (click)="closeModal()">
          Cancelar
        </button>
      </div>
    </form>
  </div>
</div>
